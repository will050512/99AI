
/**
 * 由 Fantastic-admin 提供技術支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as le}from"./index.vue_vue_type_script_setup_true_lang-DpYLhOHb.js";import{_ as oe}from"./index.vue_vue_type_script_setup_true_lang-BTce45WY.js";import{d as ne,r as p,m as D,n as P,a as se,p as n,q as re,g as w,c as q,b as e,w as l,h as u,v as ie,x as ue,F as de,s as pe,i as s,y as me,z as B,t as I,e as C,D as ce,E as _e,G as S,j as fe,_ as ge,k as M}from"./index-nGFMSQGw.js";import{A as k}from"./app-BCL1kqkG.js";import{u as ve}from"./utcformatTime-Bq4gDWNx.js";import{E as be,Q as ye}from"./index-BE-LteFu.js";const we=C("div",{class:"flex items-center gap-4"},"應用分類配置",-1),ke=C("div",{class:"text-sm/6"},[C("div",null,"應用分類可能會被多個用戶收藏，一旦創建，不建議刪除。")],-1),Ce={class:"mr-5 flex justify-end"},Ve=ne({__name:"classify",setup(xe){const U=p(),$=p(0),m=p(!1),y=p(!1);p("/api/upload/file");const r=D({name:"",status:"",page:1,size:10}),V=p(),c=p(0),i=D({name:"",des:"",coverImg:"",order:100,status:0}),N=D({name:[{required:!0,message:"請填寫分類名稱",trigger:"blur"}],des:[{required:!1,message:"請填寫分類描述",trigger:"blur"}],coverImg:[{required:!1,message:"請填寫分類封面圖片地址",trigger:"blur"}],order:[{required:!1,message:"請填寫排序ID",trigger:"blur"}],status:[{required:!0,message:"請選擇分類狀態",trigger:"change"}]}),h=p([]),R=P(()=>c.value?"更新分類":"新增分類"),j=P(()=>c.value?"確認更新":"確認新增");async function d(){try{y.value=!0;const o=await k.queryCats(r),{rows:t,count:v}=o.data;y.value=!1,$.value=v,h.value=t}catch{y.value=!1}}function F(o){c.value=o.id;const{name:t,status:v,des:x,order:z,coverImg:b}=o;_e(()=>{Object.assign(i,{name:t,status:v,des:x,order:z,coverImg:b})}),m.value=!0}function O(o){c.value=0,o==null||o.resetFields()}async function Y(o){await k.deleteCats({id:o.id}),S.success("刪除分類成功"),d()}function K(o){o==null||o.resetFields(),d()}function L(o){o==null||o.validate(async t=>{t&&(c.value?(await k.updateCats({id:c.value,...i}),S({type:"success",message:"更新分類成功！"})):(await k.createCats(i),S({type:"success",message:"創建新的分類成功！"})),m.value=!1,d())})}return se(()=>{d()}),(o,t)=>{const v=fe,x=ge,z=oe,b=n("el-input"),_=n("el-form-item"),H=n("el-option"),Q=n("el-select"),f=n("el-button"),T=n("el-form"),A=le,g=n("el-table-column"),G=n("el-tag"),J=n("el-popconfirm"),W=n("el-table"),X=n("el-pagination"),Z=n("el-row"),E=n("el-switch"),ee=n("el-dialog"),te=re("loading");return w(),q("div",null,[e(z,null,{title:l(()=>[we]),content:l(()=>[ke]),default:l(()=>[e(x,{outline:"",onClick:t[0]||(t[0]=a=>m.value=!0)},{default:l(()=>[e(v,{name:"ic:baseline-plus"}),u(" 新增分類 ")]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(T,{ref_key:"formRef",ref:U,inline:!0,model:r},{default:l(()=>[e(_,{label:"分類名稱",prop:"name"},{default:l(()=>[e(b,{modelValue:r.name,"onUpdate:modelValue":t[1]||(t[1]=a=>r.name=a),placeholder:"分類名稱[模糊搜索]",onKeydown:ie(ue(d,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),_:1}),e(_,{label:"分類狀態",prop:"status"},{default:l(()=>[e(Q,{modelValue:r.status,"onUpdate:modelValue":t[2]||(t[2]=a=>r.status=a),placeholder:"請選擇分類狀態",clearable:"",style:{width:"160px"}},{default:l(()=>[(w(!0),q(de,null,pe(s(be),a=>(w(),B(H,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,null,{default:l(()=>[e(f,{type:"primary",onClick:d},{default:l(()=>[u(" 查詢 ")]),_:1}),e(f,{onClick:t[3]||(t[3]=a=>K(s(U)))},{default:l(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(A,{style:{width:"100%"}},{default:l(()=>[me((w(),B(W,{border:"",data:s(h),style:{width:"100%"},size:"large"},{default:l(()=>[e(g,{prop:"name",label:"分類名稱"}),e(g,{prop:"appCount",label:"應用數量"}),e(g,{prop:"order",label:"排序ID"}),e(g,{prop:"status",label:"分類狀態"},{default:l(a=>[e(G,{type:a.row.status===1?"success":"danger"},{default:l(()=>[u(I(s(ye)[a.row.status]),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"createdAt",label:"創建時間",width:"200"},{default:l(a=>[u(I(s(ve)(a.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),e(g,{label:"操作",width:"200"},{default:l(a=>[e(f,{link:"",type:"primary",size:"small",onClick:ae=>F(a.row)},{default:l(()=>[u(" 編輯 ")]),_:2},1032,["onClick"]),e(J,{title:"確認刪除此分類麼?",width:"200","icon-color":"red",onConfirm:ae=>Y(a.row)},{reference:l(()=>[e(f,{link:"",type:"danger",size:"small"},{default:l(()=>[u(" 刪除分類 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[te,s(y)]]),e(Z,{class:"mt-5 flex justify-end"},{default:l(()=>[e(X,{"current-page":r.page,"onUpdate:currentPage":t[4]||(t[4]=a=>r.page=a),"page-size":r.size,"onUpdate:pageSize":t[5]||(t[5]=a=>r.size=a),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:s($),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(ee,{modelValue:s(m),"onUpdate:modelValue":t[11]||(t[11]=a=>ce(m)?m.value=a:null),"close-on-click-modal":!1,title:s(R),width:"570",onClose:t[12]||(t[12]=a=>O(s(V)))},{footer:l(()=>[C("span",Ce,[e(f,{onClick:t[9]||(t[9]=a=>m.value=!1)},{default:l(()=>[u("取消")]),_:1}),e(f,{type:"primary",onClick:t[10]||(t[10]=a=>L(s(V)))},{default:l(()=>[u(I(s(j)),1)]),_:1})])]),default:l(()=>[e(T,{ref_key:"formPackageRef",ref:V,"label-position":"right","label-width":"100px",model:i,rules:N},{default:l(()=>[e(_,{label:"分類名稱",prop:"name"},{default:l(()=>[e(b,{modelValue:i.name,"onUpdate:modelValue":t[6]||(t[6]=a=>i.name=a),placeholder:"請填寫分類名稱"},null,8,["modelValue"])]),_:1}),e(_,{label:"分類狀態",prop:"status"},{default:l(()=>[e(E,{modelValue:i.status,"onUpdate:modelValue":t[7]||(t[7]=a=>i.status=a),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(_,{label:"排序ID",prop:"order"},{default:l(()=>[e(b,{modelValue:i.order,"onUpdate:modelValue":t[8]||(t[8]=a=>i.order=a),modelModifiers:{number:!0},placeholder:"請填寫排序ID[數字越大越靠前]"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});typeof M=="function"&&M(Ve);export{Ve as default};
