
/**
 * 由 Fantastic-admin 提供技術支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-BTce45WY.js";import{d as Q,m as X,r as F,a as Y,p,g as s,c as v,b as e,w as a,h as Z,z as _,i as g,B as V,C as P,A as U,e as I,G as k,j as ee,_ as ae,H as R,k as S}from"./index-nGFMSQGw.js";import{a as B}from"./config-CYXO1pNF.js";const te=I("div",{class:"flex items-center gap-4"},"網站基礎配置",-1),le=I("div",{class:"text-sm/6"},[I("div",null," 網站基礎配置支持即時更新網站的主要視覺與功能元素。配置內容包括網站名稱、備案號、版權資訊、LOGO與ICO、默認AI頭像與用戶頭像，以及首頁設置等。 "),I("div",null,"請認真填寫各項配置，確保提供給用戶的資訊準確無誤。")],-1),oe=["src"],ne=["src"],se=["src"],re=["src"],ie=Q({__name:"baseConfiguration",setup(ce){const t=X({siteName:"",robotAvatar:"",userDefautlAvatar:"",filingNumber:"",companyName:"",buyCramiAddress:"",siteUrl:"",isShowAppCatIcon:"",clientFavoIconPath:"",clientLogoPath:""}),G=F({siteName:[{required:!0,trigger:"blur",message:"請填寫網站名稱"}]}),N=F(),h=F(`/api/upload/file?dir=${encodeURIComponent("system/others")}`);async function L(){const l=await B.queryConfig({keys:["siteName","robotAvatar","userDefautlAvatar","filingNumber","companyName","isShowAppCatIcon","clientLogoPath","clientFavoIconPath","siteUrl"]});Object.assign(t,l.data)}function T(){var l;(l=N.value)==null||l.validate(async o=>{if(o){try{await B.setConfig({settings:K(t)}),k.success("變更配置資訊成功")}catch{}L()}else k.error("請填寫完整資訊")})}async function b(l){const o=await R.get(l,{responseType:"blob"});let r="downloaded_file";const i=o.headers["content-disposition"];if(i){const y=/filename="([^"]+)"/.exec(i);y!=null&&y[1]&&(r=y[1])}else r=$(l);return new File([o.data],r,{type:o.data.type})}function $(l){const r=new URL(l).pathname;return r.substring(r.lastIndexOf("/")+1)}function x(l,o){const r=new FormData;r.append("file",l),R.post(h.value,r,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{o(i.data)}).catch(i=>{console.error("上傳失敗",i)})}const C=(l,o)=>{console.log("response: ",l.data),t.clientLogoPath=l.data};async function q(){if(t.clientLogoPath){const l=await b(t.clientLogoPath);x(l,C)}}async function E(){if(t.clientFavoIconPath){const l=await b(t.clientFavoIconPath);x(l,D)}}async function H(){if(t.robotAvatar){const l=await b(t.robotAvatar);x(l,j)}}async function z(){if(t.userDefautlAvatar){const l=await b(t.userDefautlAvatar);x(l,O)}}const D=(l,o)=>{console.log("response: ",l.data),t.clientFavoIconPath=l.data},j=(l,o)=>{console.log("response: ",l.data),t.robotAvatar=l.data},O=(l,o)=>{console.log("response: ",l.data),t.userDefautlAvatar=l.data},w=l=>{if(["image/png","image/jpeg","image/gif","image/webp"].includes(l.type)){if(l.size/1024>300)return k.error("當前限制文件最大不超過 300KB!"),!1}else return k.error("當前系統僅支持 PNG、JPEG、GIF、和 WebP 格式的圖片!"),!1};function K(l){return Object.keys(l).map(o=>({configKey:o,configVal:l[o]}))}return Y(()=>{L()}),(l,o)=>{const r=ee,i=ae,y=W,c=p("el-input"),u=p("el-form-item"),d=p("el-col"),f=p("el-row"),m=p("el-icon"),A=p("el-upload"),M=p("el-form"),J=p("el-card");return s(),v("div",null,[e(y,null,{title:a(()=>[te]),content:a(()=>[le]),default:a(()=>[e(i,{outline:"",onClick:T},{default:a(()=>[e(r,{name:"i-ri:file-text-line"}),Z(" 保存設置 ")]),_:1})]),_:1}),e(J,{style:{margin:"20px"}},{default:a(()=>[e(M,{ref_key:"formRef",ref:N,rules:G.value,model:t,"label-width":"150px"},{default:a(()=>[e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"網站名稱",prop:"siteName"},{default:a(()=>[e(c,{modelValue:t.siteName,"onUpdate:modelValue":o[0]||(o[0]=n=>t.siteName=n),placeholder:"網站名稱",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"網站地址",prop:"siteUrl"},{default:a(()=>[e(c,{modelValue:t.siteUrl,"onUpdate:modelValue":o[1]||(o[1]=n=>t.siteUrl=n),placeholder:"網站地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"公司/組織名稱",prop:"companyName"},{default:a(()=>[e(c,{modelValue:t.companyName,"onUpdate:modelValue":o[2]||(o[2]=n=>t.companyName=n),placeholder:"填入具體的公司或組織名稱",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"網站備案號",prop:"filingNumber"},{default:a(()=>[e(c,{modelValue:t.filingNumber,"onUpdate:modelValue":o[3]||(o[3]=n=>t.filingNumber=n),placeholder:"填寫網站備案資訊的備案號",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"用戶端LOGO",prop:"clientLogoPath"},{default:a(()=>[e(c,{modelValue:t.clientLogoPath,"onUpdate:modelValue":o[4]||(o[4]=n=>t.clientLogoPath=n),placeholder:"請填寫或上傳網站 LOGO 圖片 URL",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:h.value,"show-file-list":!1,"on-success":C,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.clientLogoPath?(s(),v("img",{key:0,src:t.clientLogoPath,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,oe)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(V))]),_:1}))]),_:1},8,["action"]),t.clientLogoPath?(s(),_(m,{key:0,onClick:q,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(P))]),_:1})):U("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"網站 ico",prop:"clientFavoIconPath"},{default:a(()=>[e(c,{modelValue:t.clientFavoIconPath,"onUpdate:modelValue":o[5]||(o[5]=n=>t.clientFavoIconPath=n),placeholder:"請填寫或上傳網站 ico URL",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:h.value,"show-file-list":!1,"on-success":D,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.clientFavoIconPath?(s(),v("img",{key:0,src:t.clientFavoIconPath,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,ne)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(V))]),_:1}))]),_:1},8,["action"]),t.clientFavoIconPath?(s(),_(m,{key:0,onClick:E,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(P))]),_:1})):U("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"AI頭像",prop:"robotAvatar"},{default:a(()=>[e(c,{modelValue:t.robotAvatar,"onUpdate:modelValue":o[6]||(o[6]=n=>t.robotAvatar=n),placeholder:"請填寫或上傳網站 AI 頭像 URL、為空將根據模型自動顯示",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:h.value,"show-file-list":!1,"on-success":j,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.robotAvatar?(s(),v("img",{key:0,src:t.robotAvatar,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,se)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(V))]),_:1}))]),_:1},8,["action"]),t.robotAvatar?(s(),_(m,{key:0,onClick:H,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(P))]),_:1})):U("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(u,{label:"用戶默認頭像",prop:"userDefautlAvatar"},{default:a(()=>[e(c,{modelValue:t.userDefautlAvatar,"onUpdate:modelValue":o[7]||(o[7]=n=>t.userDefautlAvatar=n),placeholder:"請填寫或上傳網站新用戶默認的頭像 URL",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:h.value,"show-file-list":!1,"on-success":O,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.userDefautlAvatar?(s(),v("img",{key:0,src:t.userDefautlAvatar,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,re)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(V))]),_:1}))]),_:1},8,["action"]),t.userDefautlAvatar?(s(),_(m,{key:0,onClick:z,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(P))]),_:1})):U("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}});typeof S=="function"&&S(ie);export{ie as default};
