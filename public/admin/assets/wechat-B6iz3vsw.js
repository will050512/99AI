
/**
 * 由 Fantastic-admin 提供技術支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as U}from"./index.vue_vue_type_script_setup_true_lang-BTce45WY.js";import{d as K,m as P,r as f,a as w,p as d,g as A,c as k,b as e,w as a,h as q,e as i,G as _,j as N,_ as M,k as h}from"./index-nGFMSQGw.js";import{a as g}from"./config-CYXO1pNF.js";const B=i("div",{class:"flex items-center gap-4"},"微信支付設置",-1),j=i("div",{class:"text-sm/6"},[i("div",null," 同時開啟多個支付，將以微信支付作為最高優先級，在pc端會調用 native 支付，在微信環境內將調用 Jsapi 支付。 "),i("div",null," 請確認微信支付已經申請了支付權限，支付通知地址為： https://您的網域名稱/api/pay/notify。 ")],-1),$=K({__name:"wechat",setup(D){const l=P({payWechatStatus:"",payWeChatMchId:"",payWeChatAppId:"",payWeChatSecret:"",payWeChatNotifyUrl:"",payWeChatPublicKey:"",payWeChatPrivateKey:""}),C=f({payWechatStatus:[{required:!0,trigger:"change",message:"請選擇當前支付開啟狀態"}],payWeChatSecret:[{required:!0,trigger:"blur",message:"請填寫支付Secret秘鑰"}],payWeChatMchId:[{required:!0,trigger:"blur",message:"請填寫商戶號"}],payWeChatAppId:[{required:!0,trigger:"blur",message:"請填寫AppId"}],payWeChatNotifyUrl:[{required:!0,trigger:"blur",message:"請填寫支付通知地址"}],payWeChatPublicKey:[{required:!0,trigger:"blur",message:"請填寫支付公鑰資訊（cert.pem文件）"}],payWeChatPrivateKey:[{required:!0,trigger:"blur",message:"請填寫支付私鑰地址（key.pem文件）"}]}),c=f();async function m(){const r=await g.queryConfig({keys:["payWeChatSecret","payWeChatNotifyUrl","payWeChatAppId","payWechatStatus","payWeChatMchId","payWeChatPublicKey","payWeChatPrivateKey"]});Object.assign(l,r.data)}function W(){var r;(r=c.value)==null||r.validate(async t=>{if(t){try{await g.setConfig({settings:b(l)}),_.success("變更配置資訊成功")}catch{}m()}else _.error("請填寫完整資訊")})}function b(r){return Object.keys(r).map(t=>({configKey:t,configVal:r[t]}))}return w(()=>{m()}),(r,t)=>{const y=N,x=M,V=U,v=d("el-switch"),p=d("el-form-item"),u=d("el-col"),n=d("el-row"),s=d("el-input"),I=d("el-form"),S=d("el-card");return A(),k("div",null,[e(V,null,{title:a(()=>[B]),content:a(()=>[j]),default:a(()=>[e(x,{outline:"",onClick:W},{default:a(()=>[e(y,{name:"i-ri:file-text-line"}),q(" 保存設置 ")]),_:1})]),_:1}),e(S,{style:{margin:"20px"}},{default:a(()=>[e(I,{ref_key:"formRef",ref:c,rules:C.value,model:l,"label-width":"140px"},{default:a(()=>[e(n,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"啟用當前支付",prop:"payWechatStatus"},{default:a(()=>[e(v,{modelValue:l.payWechatStatus,"onUpdate:modelValue":t[0]||(t[0]=o=>l.payWechatStatus=o),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"商戶ID",prop:"payWeChatMchId"},{default:a(()=>[e(s,{modelValue:l.payWeChatMchId,"onUpdate:modelValue":t[1]||(t[1]=o=>l.payWeChatMchId=o),placeholder:"請填寫商戶ID",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"AppId",prop:"payWeChatAppId"},{default:a(()=>[e(s,{modelValue:l.payWeChatAppId,"onUpdate:modelValue":t[2]||(t[2]=o=>l.payWeChatAppId=o),placeholder:"請填寫AppId",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"商戶秘鑰",prop:"payWeChatSecret"},{default:a(()=>[e(s,{modelValue:l.payWeChatSecret,"onUpdate:modelValue":t[3]||(t[3]=o=>l.payWeChatSecret=o),placeholder:"請填寫Secret秘鑰",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"支付通知地址",prop:"payWeChatNotifyUrl"},{default:a(()=>[e(s,{modelValue:l.payWeChatNotifyUrl,"onUpdate:modelValue":t[4]||(t[4]=o=>l.payWeChatNotifyUrl=o),placeholder:"請填寫支付通知地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"公鑰地址",prop:"payWeChatPublicKey"},{default:a(()=>[e(s,{modelValue:l.payWeChatPublicKey,"onUpdate:modelValue":t[5]||(t[5]=o=>l.payWeChatPublicKey=o),type:"textarea",rows:6,placeholder:"請填寫支付公鑰資訊（cert.pem文件）",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"私鑰地址",prop:"payWeChatPrivateKey"},{default:a(()=>[e(s,{modelValue:l.payWeChatPrivateKey,"onUpdate:modelValue":t[6]||(t[6]=o=>l.payWeChatPrivateKey=o),type:"textarea",rows:6,placeholder:"請填寫支付私鑰地址（key.pem文件）",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}});typeof h=="function"&&h($);export{$ as default};
