
/**
 * 由 Fantastic-admin 提供技術支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as B}from"./index.vue_vue_type_script_setup_true_lang-BTce45WY.js";import{d as D,m as O,r as E,a as j,p as n,g,c as b,b as e,w as a,h as x,F as L,s as M,e as i,G as U,j as $,_ as F,t as H,k as V}from"./index-nGFMSQGw.js";import{a as v}from"./config-CYXO1pNF.js";const J=i("div",{class:"flex items-center gap-4"},"易支付設置",-1),z=i("div",{class:"text-sm/6"},[i("div",null,"通用易支付渠道，請按文檔配置即可。"),i("div",null,"支付通知地址為： https://您的網域名稱/api/pay/notify。")],-1),G=D({__name:"epay",setup(K){const t=O({payEpayStatus:"",payEpayPid:"",payEpaySecret:"",payEpayNotifyUrl:"",payEpayReturnUrl:"",payEpayApiPayUrl:"",payEpayApiQueryUrl:"",payEpayRedirect:"",payEpayChannel:[]}),P=E({payEpayStatus:[{required:!0,trigger:"change",message:"請選擇當前支付開啟狀態"}],payEpaySecret:[{required:!0,trigger:"blur",message:"請填寫支付秘鑰"}],payEpayPid:[{required:!0,trigger:"blur",message:"請填寫商戶PID"}],payEpayNotifyUrl:[{required:!0,trigger:"blur",message:"請填寫支付通知地址"}],payEpayApiPayUrl:[{required:!0,trigger:"blur",message:"請填寫平臺支付API請求地址"}],payEpayApiQueryUrl:[{required:!0,trigger:"blur",message:"請填寫平臺API商戶查詢地址"}]}),s=E(),C=[{label:"微信支付",value:"wxpay"},{label:"支付寶支付",value:"alipay"}];async function m(){const o=await v.queryConfig({keys:["payEpaySecret","payEpayNotifyUrl","payEpayReturnUrl","payEpayPid","payEpayStatus","payEpayApiPayUrl","payEpayApiQueryUrl","payEpayRedirect","payEpayChannel"]}),l=o.data.payEpayChannel?JSON.parse(o.data.payEpayChannel):[];Object.assign(t,o.data,{payEpayChannel:l})}function S(){var o;(o=s.value)==null||o.validate(async l=>{if(l){try{await v.setConfig({settings:A(t)}),U.success("變更配置資訊成功")}catch{}m()}else U.error("請填寫完整資訊")})}function h(o,l){if(["payEpayChannel"].includes(o)){if(!l)return[];if(l)return JSON.stringify(l)}else return l}function A(o){return Object.keys(o).map(l=>({configKey:l,configVal:h(l,o[l])}))}return j(()=>{m()}),(o,l)=>{const c=$,k=F,w=B,f=n("el-switch"),r=n("el-form-item"),u=n("el-col"),y=n("el-row"),d=n("el-input"),_=n("el-divider"),R=n("el-tooltip"),N=n("el-checkbox"),q=n("el-checkbox-group"),I=n("el-form"),Q=n("el-card");return g(),b("div",null,[e(w,null,{title:a(()=>[J]),content:a(()=>[z]),default:a(()=>[e(k,{outline:"",onClick:S},{default:a(()=>[e(c,{name:"i-ri:file-text-line"}),x(" 保存設置 ")]),_:1})]),_:1}),e(Q,{style:{margin:"20px"}},{default:a(()=>[e(I,{ref_key:"formRef",ref:s,rules:P.value,model:t,"label-width":"120px"},{default:a(()=>[e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"啟用當前支付",prop:"payEpayPid"},{default:a(()=>[e(f,{modelValue:t.payEpayStatus,"onUpdate:modelValue":l[0]||(l[0]=p=>t.payEpayStatus=p),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"商戶PID",prop:"payEpayPid"},{default:a(()=>[e(d,{modelValue:t.payEpayPid,"onUpdate:modelValue":l[1]||(l[1]=p=>t.payEpayPid=p),placeholder:"請填寫商戶PID",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"商戶秘鑰",prop:"payEpaySecret"},{default:a(()=>[e(d,{modelValue:t.payEpaySecret,"onUpdate:modelValue":l[2]||(l[2]=p=>t.payEpaySecret=p),placeholder:"請填寫商戶秘鑰",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"支付通知地址",prop:"payEpaySecret"},{default:a(()=>[e(d,{modelValue:t.payEpayNotifyUrl,"onUpdate:modelValue":l[3]||(l[3]=p=>t.payEpayNotifyUrl=p),placeholder:"請填寫支付通知地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"支付回調地址",prop:"payEpaySecret"},{default:a(()=>[e(d,{modelValue:t.payEpayReturnUrl,"onUpdate:modelValue":l[4]||(l[4]=p=>t.payEpayReturnUrl=p),placeholder:"請填寫支付成功後的回跳地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"支付請求地址",prop:"payEpayApiPayUrl"},{default:a(()=>[e(d,{modelValue:t.payEpayApiPayUrl,"onUpdate:modelValue":l[5]||(l[5]=p=>t.payEpayApiPayUrl=p),placeholder:"請填寫平臺支付請求地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"商戶查詢地址",prop:"payEpayApiQueryUrl"},{default:a(()=>[e(d,{modelValue:t.payEpayApiQueryUrl,"onUpdate:modelValue":l[6]||(l[6]=p=>t.payEpayApiQueryUrl=p),placeholder:"請填寫平臺查詢商戶地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"是否開啟跳轉支付",prop:"payEpayRedirect","label-width":"130px"},{default:a(()=>[e(R,{class:"box-item",effect:"dark",content:"請注意、僅mapi支持不跳轉支付、其他都需要為跳轉支付、不開啟跳轉支付表示購買頁面顯示二維碼直接掃碼購買、跳轉支付表示前往新頁面！",placement:"right"},{default:a(()=>[e(f,{modelValue:t.payEpayRedirect,"onUpdate:modelValue":l[7]||(l[7]=p=>t.payEpayRedirect=p),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:24,lg:24,xl:24},{default:a(()=>[e(r,{label:"開啟支付渠道",prop:"payEpayChannel"},{default:a(()=>[e(q,{modelValue:t.payEpayChannel,"onUpdate:modelValue":l[8]||(l[8]=p=>t.payEpayChannel=p),size:"small"},{default:a(()=>[(g(),b(L,null,M(C,p=>e(N,{key:p.value,border:"",label:p.value},{default:a(()=>[x(H(p.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}});typeof V=="function"&&V(G);export{G as default};
